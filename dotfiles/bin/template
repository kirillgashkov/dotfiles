#!/bin/sh

fatal() {
    echo "$(basename $0): $@"
    exit 1
}


library="${XDG_CONFIG_HOME:-$HOME/.config}/template/library"
file_name="$(basename "$(dirname "$library/$1")")"


if [ -z "$1" ]; then
    fatal "template file was not specified"
fi

if [ ! -e "$library/$1" ]; then
    fatal "template file does not exist in the library"
fi

if [ ! -f "$library/$1" ]; then
    fatal "template file is not a regular file"
fi

[ -n "$2" ] && did_cd=0 && mkdir "$2" && cd "$2" && did_cd=1

if [ "$did_cd" = 0 ]; then
    fatal "destination directory cannot be reached"
fi


cp "$library/$1" "$PWD/$filename"
